<!DOCTYPE html>
<html lang="en">
<head>
   <!-- Add your CSS styles here -->
</head>
<body>
    <div class="container">
        <h2>Dog Info</h2>
        
        <br />
        <div class="form">
            <label for="username">Username:</label>
            <input type="text" name="username" id="username" /> <br /><br />
            
            <label for="bookname">Dog Breed:</label>
            <input type="text" name="bookname" id="bookname" /> <br /><br />
           
           <select name="dogtype" id="dogtype">
                <option selected hidden>Select Dog type</option>
                <option value="straydog">Stray Dog</option>
                <option value="housedog">House Dog</option>
            </select><br /><br />
            
            <select name="gender" id="gender">
                <option selected hidden>Select Dog Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select><br /><br />

            <label for="desc">About Dog condition:</label>
            <input type="text" name="desc" id="desc" /> <br /><br />
            
            <h1>User Location</h1>
            <button onclick="getLocation()">Get Location</button>
            <div id="location"></div>
            <h1>User upload images</h1>
            <input type="file" accept="image/*" capture="environment" id="file-input"/>
            <input type="hidden" name="latitude" id="latitude" />
            <input type="hidden" name="longitude" id="longitude" />
        </div>

        <div class="buttons">
            <button id="insert">Insert</button>
        </div>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/8.4.2/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.2/firebase-storage.js"></script>
    <script>
        // Initialize Firebase Storage
        var storage = firebase.storage();
        var storageRef = storage.ref();

        document.getElementById("insert").addEventListener("click", function() {
            var file = document.getElementById("file-input").files[0];
            var username = document.getElementById("username").value;
            var bookName = document.getElementById("bookname").value;

            // Create a storage reference with a unique filename
            var fileName = file.name + "_" + new Date().getTime();
            var fileRef = storageRef.child(fileName);

            // Upload file to Firebase Storage
            fileRef.put(file).then(function(snapshot) {
                console.log("File uploaded successfully");

                // Get the download URL of the uploaded file
                fileRef.getDownloadURL().then(function(url) {
                    // Save the file URL, username, and other information to your database
                    // You can use Firestore or Realtime Database to store this information
                    // For simplicity, I'll just log the values here
                    console.log("Username:", username);
                    console.log("File URL:", url);
                    console.log("Dog Breed:", bookName);
                }).catch(function(error) {
                    console.log("Error getting download URL:", error);
                });
            }).catch(function(error) {
                console.log("Error uploading file:", error);
            });
        });

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        }

        function showPosition(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            var locationElement = document.getElementById("location");
            locationElement.textContent = "Latitude: " + latitude + "\nLongitude: " + longitude;

            // Set the latitude and longitude values in the hidden input fields
            document.getElementById("latitude").value = latitude;
            document.getElementById("longitude").value = longitude;
        }

        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    alert("User denied the request for Geolocation.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert("Location information is unavailable.");
                    break;
                case error.TIMEOUT:
                    alert("The request to get user location timed out.");
                    break;
                case error.UNKNOWN_ERROR:
                    alert("An unknown error occurred.");
                    break;
            }
        }
    </script>
</body>
</html>
